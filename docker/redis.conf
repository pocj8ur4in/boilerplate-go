#------------------------------------------------------------------------------
# NETWORK
#------------------------------------------------------------------------------

# TCP listen backlog (higher values allow more pending connections)
tcp-backlog 511

# Close the connection after a client is idle for N seconds (0 = disabled)
timeout 0

# TCP keepalive in seconds (0 = disabled)
tcp-keepalive 300

#------------------------------------------------------------------------------
# GENERAL
#------------------------------------------------------------------------------

# Run as a daemon (no, run in foreground for Docker)
daemonize no

# Server verbosity level (debug/verbose/notice/warning)
loglevel notice

#------------------------------------------------------------------------------
# MEMORY MANAGEMENT
#------------------------------------------------------------------------------

# Memory usage limit in bytes (0 = no limit)
# When the memory limit is reached Redis will try to remove keys according to eviction policy
maxmemory 256mb

# Eviction policy when maxmemory is reached
# Options: volatile-lru, allkeys-lru, volatile-lfu, allkeys-lfu, volatile-random, allkeys-random, volatile-ttl, noeviction
maxmemory-policy allkeys-lru

#------------------------------------------------------------------------------
# APPEND ONLY FILE (AOF)
#------------------------------------------------------------------------------

# AOF is more durable than RDB snapshots (logs every write operation)
appendonly no

# The name of the append only file
appendfilename "appendonly.aof"

# fsync() call options: no (fastest), always (safest, slowest), everysec (compromise, default)
appendfsync everysec

# Automatic rewrite of the append only file
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb

#------------------------------------------------------------------------------
# SLOW LOG
#------------------------------------------------------------------------------

# Slow log threshold in microseconds (1000000 = 1 second, negative = disabled, 0 = log all)
slowlog-log-slower-than 10000

# Maximum length of slow log
slowlog-max-len 128

#------------------------------------------------------------------------------
# LATENCY MONITOR
#------------------------------------------------------------------------------

# Redis latency monitoring framework threshold in milliseconds (0 = disabled)
latency-monitor-threshold 0

#------------------------------------------------------------------------------
# ADVANCED CONFIG
#------------------------------------------------------------------------------

# Active rehashing: use 1 millisecond every 100 milliseconds of CPU time to help rehashing
activerehashing yes

# Frequency of background tasks (hz, 1-500, default: 10)
# Higher values use more CPU but make Redis more responsive
hz 10

# Client output buffer limits (normal, replica, pubsub)
client-output-buffer-limit normal 0 0 0
client-output-buffer-limit replica 256mb 64mb 60
client-output-buffer-limit pubsub 32mb 8mb 60

# Client query buffer limit
client-query-buffer-limit 1gb

# Protocol buffer limit
proto-max-bulk-len 512mb
